# 校园互助平台前后端对接完整需求方案

## 1. 项目概述

本方案旨在规范校园互助平台前后端对接的接口设计、数据模型和开发流程，确保前后端开发团队能够高效协作，实现一个功能完整、性能优良的校园互助平台。

## 2. 项目架构

- **前端**：
  - 学生端：微信小程序
  - 管理端：Web管理系统
- **后端**：Spring Boot API服务

## 3. 目录结构

```
项目根目录
├── backend/               # 后端项目（已存在）
│   ├── src/
│   └── ...
└── frontend/             # 前端项目
    ├── miniprogram/      # 微信小程序
    │   ├── pages/        # 页面目录
    │   ├── components/   # 组件目录
    │   ├── api/          # API模块
    │   ├── store/        # 状态管理
    │   ├── utils/        # 工具函数
    │   └── static/       # 静态资源
    └── web-admin/        # Web管理系统
        ├── src/
        │   ├── views/     # 页面视图
        │   ├── components/ # 组件
        │   ├── api/        # API模块
        │   ├── store/      # 状态管理
        │   ├── utils/      # 工具函数
        │   └── router/     # 路由配置
        └── public/         # 静态资源
```

## 4. 接口规范

### 4.1 统一响应格式

所有API接口返回统一的格式：

```json
{
  "code": 200,        // 状态码，200=成功，其他为错误
  "msg": "成功",       // 提示信息
  "data": {}          // 业务数据
}
```

### 4.2 错误码定义

| 错误码 | 描述 |
|--------|------|
| 200    | 成功 |
| 400    | 参数错误 |
| 401    | 未授权 |
| 403    | 权限不足 |
| 404    | 资源不存在 |
| 500    | 服务器内部错误 |

### 4.3 核心API清单

#### 4.3.1 用户模块

| 接口路径 | 方法 | 功能描述 | 前端模块 |
|----------|------|----------|----------|
| `/user/register` | POST | 用户注册 | 小程序端 |
| `/user/login` | POST | 用户登录 | 小程序端 |
| `/user/info` | GET | 获取用户信息 | 小程序端 |
| `/user/switchRole` | POST | 切换角色 | 小程序端 |
| `/admin/users` | GET | 获取用户列表 | 管理端 |
| `/admin/user/audit` | POST | 用户审核 | 管理端 |

#### 4.3.2 任务模块

| 接口路径 | 方法 | 功能描述 | 前端模块 |
|----------|------|----------|----------|
| `/task/list` | GET | 获取任务列表 | 小程序端 |
| `/task/create` | POST | 创建任务 | 小程序端 |
| `/task/{id}` | GET | 获取任务详情 | 小程序端 |
| `/task/{id}/accept` | POST | 接单 | 小程序端 |
| `/task/{id}/complete` | POST | 完成任务 | 小程序端 |
| `/admin/tasks` | GET | 获取任务列表 | 管理端 |
| `/admin/task/audit` | POST | 任务审核 | 管理端 |

#### 4.3.3 区块链模块

| 接口路径 | 方法 | 功能描述 | 前端模块 |
|----------|------|----------|----------|
| `/blockchain/point/upload` | POST | 积分上链 | 小程序端 |
| `/blockchain/point/query` | GET | 查询链上积分 | 小程序端 |

## 5. 数据模型对接

### 5.1 核心数据模型

| 前端模型 | 后端实体/DTO | 用途 |
|----------|--------------|------|
| UserLoginParams | UserLoginDTO | 登录请求参数 |
| UserRegisterParams | UserRegisterDTO | 注册请求参数 |
| TaskCreateParams | TaskCreateDTO | 创建任务参数 |
| UserInfo | UserVO | 用户信息返回 |
| TaskInfo | TaskVO | 任务信息返回 |
| TransactionRecord | PointTransaction | 交易记录 |

### 5.2 数据类型映射

| 前端类型 | 后端类型 |
|----------|----------|
| Number | Long/Integer |
| String | String |
| Boolean | Boolean |
| Date | LocalDateTime |
| Object | 实体类 |

## 6. 开发计划

### 6.1 第一阶段：基础功能（1-2周）

**小程序端：**
- 登录/注册页面
- 首页任务列表
- 个人中心框架
- API请求封装

**管理端：**
- 登录页面
- 仪表板框架
- 用户管理列表
- 任务管理列表

### 6.2 第二阶段：核心业务（2-3周）

**小程序端：**
- 任务发布功能
- 接单/完成任务
- 积分展示
- 消息通知

**管理端：**
- 用户审核功能
- 任务审核功能
- 积分管理
- 数据统计

### 6.3 第三阶段：优化完善（1-2周）

**两端同步：**
- 性能优化
- 错误处理完善
- 用户体验优化
- 安全加固

## 7. 开发规范

### 7.1 代码规范

- **命名规范**：使用驼峰命名法
- **注释规范**：关键代码必须添加注释
- **文件结构**：按功能模块组织代码

### 7.2 安全规范

- 所有API接口必须进行身份验证
- 敏感数据必须加密传输
- 输入参数必须进行验证
- 防止SQL注入和XSS攻击

### 7.3 性能规范

- 减少HTTP请求次数
- 使用缓存机制
- 优化数据库查询
- 压缩静态资源

## 8. 测试计划

### 8.1 单元测试

- 后端：为每个Service方法编写单元测试
- 前端：为每个组件编写单元测试

### 8.2 集成测试

- 测试前后端API对接
- 测试数据流向
- 测试业务流程

### 8.3 系统测试

- 功能测试
- 性能测试
- 安全测试
- 用户体验测试

## 9. 部署计划

### 9.1 开发环境

- 后端：本地开发环境，端口8080
- 小程序：微信开发者工具
- 管理端：本地开发服务器

### 9.2 测试环境

- 后端：测试服务器，端口8080
- 小程序：体验版
- 管理端：测试域名

### 9.3 生产环境

- 后端：生产服务器，端口8080
- 小程序：正式版
- 管理端：生产域名

## 10. 风险与注意事项

1. **BlockchainService 500错误**：需要优先修复，否则积分功能无法使用
2. **数据库连接**：确保MySQL服务运行，表结构正确
3. **跨域配置**：检查WebMvcConfig.java中的跨域设置
4. **JWT配置**：确保JwtUtil.java正确配置密钥和过期时间
5. **Redis连接**：如不需要可暂时禁用Redis配置
6. **微信小程序权限**：确保获取必要的用户权限

## 11. 技术栈

### 11.1 后端

- Spring Boot
- Spring Security
- Spring Data JPA
- MySQL
- Redis
- JWT
- FISCO BCOS

### 11.2 前端

- 微信小程序：原生小程序开发
- 管理端：Vue.js/React.js
- API请求：axios/wx.request
- 状态管理：Vuex/Redux
- UI组件库：Element UI/Ant Design

## 12. 联系方式

- 后端开发负责人：
- 前端开发负责人：
- 项目负责人：

---

本方案将持续更新，以适应项目需求的变化。